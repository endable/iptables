Leaked and collected by BombTokyo aka 0x#0009

Use them if you want a high ping xD
-Some of them are actually not that bad




OVH WALLS 
sudo iptables -P INPUT ACCEPT
sudo iptables -P FORWARD ACCEPT
sudo iptables -P OUTPUT ACCEPT
sudo iptables -N AS0_ACCEPT
sudo iptables -N AS0_IN
sudo iptables -N AS0_IN_NAT
sudo iptables -N AS0_IN_POST
sudo iptables -N AS0_IN_PRE
sudo iptables -N AS0_IN_ROUTE
sudo iptables -N AS0_OUT
sudo iptables -N AS0_OUT_LOCAL
sudo iptables -N AS0_OUT_POST
sudo iptables -N AS0_OUT_S2C
sudo iptables -N AS0_WEBACCEPT
sudo iptables -N f2b-sshd
sudo iptables -N flood
sudo iptables -N http-flood
sudo iptables -N port-scanning
sudo iptables -N syn-flood
sudo iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A INPUT -m conntrack --ctstate INVALID -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -m connlimit --connlimit-above 15 --connlimit-mask 32 --connlimit-saddr -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,ACK FIN -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags PSH,ACK PSH -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags ACK,URG URG -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,RST FIN,RST -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,PSH,URG -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,PSH,URG -j DROP
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,ACK,URG
-j DROP
sudo iptables -A INPUT -p udp -m udp --dport 3074 -j ACCEPT
sudo iptables -A INPUT -p udp -m udp --dport 3075 -j ACCEPT
sudo iptables -A INPUT -m recent --rcheck --seconds 604800 --name portscan --mask 255.255.255.255 --rsource -j DROP
sudo iptables -A INPUT -m recent --remove --name portscan --mask 255.255.255.255 --rsource
sudo iptables -A INPUT -m state --state RELATED,ESTABLISHED -j AS0_ACCEPT
sudo iptables -A INPUT -i lo -j AS0_ACCEPT
sudo iptables -A INPUT -m mark --mark 0x2000000/0x2000000 -j AS0_IN_PRE
sudo iptables -A INPUT -m state --state RELATED,ESTABLISHED -j AS0_WEBACCEPT
sudo iptables -A INPUT -p tcp -m multiport --dports 22 -j f2b-sshd
sudo iptables -A INPUT -p tcp -m multiport --dports 22 -j f2b-sshd
sudo iptables -A INPUT -s 127.0.0.1/32 -j ACCEPT
sudo iptables -A INPUT -s 172.27.224.1/32 -j ACCEPT
sudo iptables -A INPUT -s 51.222.27.82 -j ACCEPT
sudo iptables -A INPUT -m conntrack --ctstate INVALID -j DROP
sudo iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A INPUT -p tcp -m connlimit --connlimit-above 10 --connlimit-mask 32 --connlimit-saddr -j DROP
sudo iptables -A INPUT -p tcp -m tcp --dport 943 -j DROP
sudo iptables -A INPUT -p tcp -m tcp --dport 62627 -j DROP
sudo iptables -A INPUT -s 10.0.0.0/8 -j DROP
sudo iptables -A INPUT -s 169.254.0.0/16 -j DROP
sudo iptables -A INPUT -s 172.16.0.0/12 -j DROP
sudo iptables -A INPUT -s 127.0.0.0/8 -j DROP
sudo iptables -A INPUT -s 224.0.0.0/4 -j DROP
sudo iptables -A INPUT -d 224.0.0.0/4 -j DROP
sudo iptables -A INPUT -s 240.0.0.0/5 -j DROP
sudo iptables -A INPUT -d 240.0.0.0/5 -j DROP
sudo iptables -A INPUT -s 0.0.0.0/8 -j DROP
sudo iptables -A INPUT -d 0.0.0.0/8 -j DROP
sudo iptables -A INPUT -d 239.255.255.0/24 -j DROP
sudo iptables -A INPUT -d 255.255.255.255/32 -j DROP
sudo iptables -A INPUT -p tcp -m
tcp --tcp-flags RST RST -m limit --limit 2/sec --limit-burst 2 -j ACCEPT
sudo iptables -A INPUT -p tcp -m tcp --tcp-flags RST RST -m limit --limit 2/sec --limit-burst 2 -j ACCEPT
sudo iptables -A INPUT -s 65.189.36.89 -p tcp -m tcp --dport 22 -j ACCEPT
sudo iptables -A INPUT -p tcp -m tcp --dport 22 -j DROP
sudo iptables -A FORWARD -m recent --rcheck --seconds 604800 --name portscan --mask 255.255.255.255 --rsource -j DROP
sudo iptables -A FORWARD -m recent --remove --name portscan --mask 255.255.255.255 --rsource
sudo iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j AS0_ACCEPT
sudo iptables -A FORWARD -m mark --mark 0x2000000/0x2000000 -j AS0_IN_PRE
sudo iptables -A FORWARD -o as0t+ -j AS0_OUT_S2C
sudo iptables -A FORWARD -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -m limit --limit 1/sec -j ACCEPT
sudo iptables -A FORWARD -p udp -m limit --limit 1/sec -j ACCEPT
sudo iptables -A FORWARD -p icmp -m icmp --icmp-type 8 -m limit --limit 1/sec -j ACCEPT
sudo iptables -A FORWARD -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK RST -m limit --limit 1/sec -j ACCEPT
sudo iptables -A OUTPUT ! -s 127.181.42.17/32 ! -d 127.138.213.242/32 -p icmp -m icmp --icmp-type 3/3 -m connmark ! --mark 0x53a7de36 -j DROP
sudo iptables -A OUTPUT ! -s 127.17.79.83/32 ! -d 127.95.130.90/32 -p tcp -m tcp --sport 61001:65535 --tcp-flags RST RST -m connmark ! --mark 0x7bc1a1f4 -j DROP
sudo iptables -A OUTPUT -o as0t+ -j AS0_OUT_LOCAL
sudo iptables -A AS0_ACCEPT -j ACCEPT
sudo iptables -A AS0_IN -d 172.27.224.1/32 -j ACCEPT
sudo iptables -A AS0_IN -j AS0_IN_POST
sudo iptables -A AS0_IN_NAT -j MARK --set-xmark 0x8000000/0x8000000
sudo iptables -A AS0_IN_NAT -j ACCEPT
sudo iptables -A AS0_IN_POST -o as0t+ -j AS0_OUT
sudo iptables -A AS0_IN_POST -j DROP
sudo iptables -A AS0_IN_PRE -d 169.254.0.0/32 -j AS0_IN
sudo iptables -A AS0_IN_PRE -d 192.168.0.0/32 -j AS0_IN
sudo iptables -A AS0_IN_PRE -d 172.16.0.0/32 -j AS0_IN
sudo iptables -A AS0_IN_PRE
-d 10.0.0.0/32 -j AS0_IN
sudo iptables -A AS0_IN_PRE -j ACCEPT
sudo iptables -A AS0_IN_ROUTE -j MARK --set-xmark 0x4000000/0x4000000
sudo iptables -A AS0_IN_ROUTE -j ACCEPT
sudo iptables -A AS0_OUT -j AS0_OUT_POST
sudo iptables -A AS0_OUT_LOCAL -p icmp -m icmp --icmp-type 5 -j DROP
sudo iptables -A AS0_OUT_LOCAL -j ACCEPT
sudo iptables -A AS0_OUT_POST -m mark --mark 0x2000000/0x2000000 -j ACCEPT
sudo iptables -A AS0_OUT_POST -j DROP
sudo iptables -A AS0_OUT_S2C -j AS0_OUT
sudo iptables -A AS0_WEBACCEPT -j ACCEPT
sudo iptables -A f2b-sshd -j RETURN
sudo iptables -A f2b-sshd -j RETURN
sudo iptables -A flood -j DROP
sudo iptables -A http-flood -j DROP
sudo iptables -A port-scanning -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK RST -m limit --limit 1/sec --limit-burst 2 -j RETURN
sudo iptables -A port-scanning -j DROP
sudo iptables -A syn-flood -m limit --limit 1/sec --limit-burst 4 -j RETURN
sudo iptables -A syn-flood -j DROP
sudo iptables -A port-scanning -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s --limit-burst 2 -j RETURN
sudo iptables -A port-scanning -j DROP
sudo iptables -A syn-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -A syn-flood -j LOG --log-prefix "SYN flood: "
sudo iptables -A syn-flood -j DROP
sudo iptables -A INPUT -i lo -p udp --destination-port 123 -j DROP
sudo iptables -A INPUT -p udp --source-port 123:123 -m state --state ESTABLISHED -j DROP
sudo iptables -N ntp-flood
sudo iptables -A ntp-flood -m limit --limit 15/sec --limit-burst 15 -j RETURN
sudo iptables -A udp-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N FIN-flood
sudo iptables -A FIN-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N RST-flood
sudo iptables -A RST-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N PSH-flood
sudo iptables -A PSH-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N ACK-flood
sudo
iptables -A ACK-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N STD-flood
sudo iptables -A STD-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N HOLD-flood
sudo iptables -A HOLD-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N JUNK-flood
sudo iptables -A JUNK-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N CNC-flood
sudo iptables -A CNC-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N ARD-flood
sudo iptables -A ARD-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -N CHARGEN-flood
sudo iptables -A CHARGEN-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -A INPUT -p udp --source-port 19:19 -m state --state ESTABLISHED -j DROP
sudo iptables -A INPUT -p tcp --source-port 19:19 -m state --state ESTABLISHED -j DROP
sudo iptables -N ldap-flood
sudo iptables -A ldap-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
sudo iptables -A INPUT -p udp --source-port 389:389 -m state --state ESTABLISHED -j DROP
sudo iptables -A INPUT -p tcp --source-port 389:389 -m state --state ESTABLISHED -j DROP
sudo iptables -A INPUT -p tcp --dport 1194 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 1194 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 1194 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport 1194 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p tcp --dport 33333 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 33333 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 33333 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport
sudo iptables -A INPUT -p tcp --dport 22 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 22 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 22 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport 22 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p tcp --dport 443 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 443 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 443 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport 443 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 80 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport 80 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p tcp --dport 443 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 443 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 443 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport 443 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p tcp --dport 62627 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p tcp --dport 62627 -i eth0 -m state --state NEW -m
recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -A INPUT -p udp --dport 62627 -i eth0 -m state --state NEW -m recent --set
sudo iptables -A INPUT -p udp --dport 62627 -i eth0 -m state --state NEW -m recent --update --seconds 150 --hitcount 10 -j DROP
sudo iptables -N UDPATTACK
sudo iptables -N DNSFLOOD
sudo iptables -N TCPFLOOD
sudo iptables -N SYNFLOOD
sudo iptables -N ACKFLOOD
sudo iptables -N STDFLOOD
sudo iptables -N udp-flood
sudo iptables -N synack-flood
sudo iptables -A INPUT -p udp -m hashlimit --hashlimit-name UDPATTACK --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p udp -m hashlimit --hashlimit-name DNSFLOOD --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p tcp -m hashlimit --hashlimit-name TCPFLOOD --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p tcp -m hashlimit --hashlimit-name SYNFLOOD --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p tcp -m hashlimit --hashlimit-name ACKFLOOD --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p udp -m hashlimit --hashlimit-name STDFLOOD --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p udp -m hashlimit --hashlimit-name udp-flood --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP
sudo iptables -A INPUT -p udp -m hashlimit
--hashlimit-name synack-flood --hashlimit-mode srcip --hashlimit-srcmask 32 --hashlimit-above 5/minute --hashlimit-burst 2 --hashlimit-htable-expire 30000 -j DROP


Your Server IP
------------------------------------------------------------------------------------------------------------------------------------



PATH WALLS 
iptables -t mangle -A PREROUTING -p udp --sport 37810 -j DROP

iptables -t mangle -A PREROUTING -p udp --sport 7001 -j DROP

iptables -I INPUT -p udp -m length --length 100:140 -m string --string "nAFS" --algo kmp -j DROP

iptables -t mangle -A PREROUTING -p udp --sport 17185 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 3072,3702 -j DROP

iptables -t mangle -A PREROUTING -p tcp -m multiport --sports 3072,3702 -j DROP


iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP

iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP

iptables -t mangle -A PREROUTING -p udp --sport 32414 -j DROP

iptables -t mangle -A PREROUTING -p udp --sport 177 -j DROP

iptables -t mangle -A PREROUTING -p udp --sport 6881 -m length --length 320:330 -j DROP

iptables -t raw -A PREROUTING -p udp --sport 3283 -j DROP 


iptables -t raw -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP 

iptables -t raw -A PREROUTING -p tcp --sport 3283 -j DROP 

iptables -t raw -A PREROUTING -p tcp --sport 3283 -m length --length 1048 -j DROP 

iptables -A INPUT -p tcp -m length --length 74 -j DROP

iptables -I INPUT -p udp -m udp -m string --hex-string "|fa163ecc45d2266f2ad6b4a6080045000038d5b000002c018e72bb78921c9e453ec803034bf6000000004548004f132b0000f1118b889e453ec8bb78921caf460185003b0000|" --algo kmp -j DROP

iptables -A INPUT -p icmp -s 196.61.112.251 -j DROP

iptables -A INPUT -p icmp -s 177.66.29.145 -j DROP

iptables -A INPUT -p icmp -s 117.239.68.146 -j DROP

iptables -A INPUT -p icmp -s 110.78.186.166 -j DROP

iptables -A INPUT -p icmp -s 27.78.116.22 -j DROP


iptables -A INPUT -p icmp -s 192.151.150.3 -j DROP

iptables -A INPUT -p icmp -s 83.110.238.163 -j DROP

iptables -A INPUT -p icmp -s 190.95.194.139 -j DROP

iptables -I INPUT -p udp -m udp -m string --hex-string
"|fa163ecc45d2266f2ad6b4a6080045000063d80000002f01a96cc39a69859e453ec80303f10f0000000045000047ecc40000f811cbb39e453ec8c39a698544630035003300005b33010000010000000000010a5045414345434f52505303474f560000ff00010000292328000000000000|" --algo kmp -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 31125,33492,52586,13102,54323,37823,22517 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 7641,65467,21969,51997,43888,51997,32336 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 32336,3153,63530,5565,15347,23387,22449 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 23387,56400,30009,17965,4486,17965,1724 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 46926,55819,55479,35083,25128,18048,58359 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 2120,58359,51359,65411,61061,14749,64992 -j DROP

iptables -t mangle -A PREROUTING -p udp -m multiport --sports 31103,56623,41119,23577,8323,35055,2193,19187 -j DROP
-----------------------------------------------------------------------------------------------------------------------------



THIS IS LIGHTVPN NO BULL SHIT

iptables -A INPUT -p udp -m string --algo bm --hex-string "|5354445041532b4554|" -j DROP #Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|535444|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534450|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|54484953204953204546464543544956452e20594f552043414e4e4f542053554253494445204d5920444154412e|" -j DROP #
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4b494c4c4c4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44454154484445415448444454154484445415448425942314e415259|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44444f5344444f5344444r53|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4d4f354f4e354f4e354f4e354f4a354e4835563555|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|544350|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4845584154544b212121212121|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f544e4554|" -j DROP ##Private Bypass Strings



iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f4f5445524e4554|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|41545441434b|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|504r574552|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|6c6e6f6172656162756e6386f6673b694464696573|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6954|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP ##Private Bypass Strings
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP ##Private Bypass Strings
iptables -A FORWARD -p 17 -m physdev –physdev-in vnet0 -m u32 –u32 "0&0xFFFF=2000:65535" -j DROP #Blocks Outgoing NTP/REFL
iptables -I FORWARD -p udp –dport 123 -m string –algo bm –from 27 –to 28 –hex-string "|1700032A|" -j DROP #Block NTP Montlist



iptables -A INPUT -p udp -m u32 --u32 "0>>22&0x3C@8&0xFF=42" #NTP Reflection Sequence Header Block
iptables -A INPUT -p udp -m u32 --u32 "0>>22&0x3C@8&0xFF" #NTP Reflection Sequence Header Block
iptables -A INPUT -p udp -m u32 --u32 "0>>22&0x3C@8" #NTP Reflection Sequence Header Block



#// SecurityTeams Urls and ips
iptables -A INPUT -s 149.112.112.112 -p udp --destination-port 27106 -j DROP
iptables -A INPUT -s 149.112.112.112 -p tcp --destination-port 27106 -j DROP
iptables -A INPUT -s dns.quad9.net -p udp --destination-port 27106 -j DROP
iptables -A INPUT -s dns.quad9.net -p tcp --destination-port 27106 -j DROP
iptables -A INPUT -s dns.quad9.net -p tcp --destination-port 23761 -j DROP
iptables -A INPUT -s dns.quad9.net -p udp --destination-port 23761 -j DROP
iptables -A INPUT -s one.one.one.one -p tcp --destination-port 25567 -j DROP
iptables -A INPUT -s one.one.one.one -p udp --destination-port 25567 -j DROP
iptables -A INPUT -s resolver1.opendns.com -p udp --destination-port 27354 -j DROP
iptables -A INPUT -s resolver1.opendns.com -p tcp --destination-port 27354 -j DROP  
#// SecurityTeam IPS
iptables -I INPUT -s dns.quad9.net -j DROP
iptables -I INPUT -s one.one.one.one -j DROP
iptables -I INPUT -s resolver1.opendns.com -j DROP       
iptables -I INPUT -s 51.15.222.43-j DROP   
iptables -I INPUT -s  185.216.212.194 -j DROP
iptables -I INPUT -s 51.0.0.0/51.255.255.255 -j DROP
iptables -I INPUT -s  185.216.212.195 -j DROP
iptables -I INPUT -s  51.15.112.33 -j DROP
iptables -I INPUT -s  51.158.125.239 -j DROP
iptables -I INPUT -s  51.15.90.100 -j DROP
iptables -I INPUT -s 51.158.119.123 -j DROP
iptables -I INPUT -s 51.15.233.74 -j DROP
iptables -I INPUT -s 51.158.173.117 -j DROP
iptables -I INPUT -s 51.15.7.144 -j DROP
#// Ports That Bypasses Use to send through
iptables -A INPUT -p tcp -m multiport --dports 53145,53148,53146,10425,53150,10427,10430,10432,10434 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 53156,53153,10438,10439,53160,53161,10441,53158,53159,10447,10443,10448,10447,10444,62488 -j DROP 
iptables -A INPUT -p udp -m multiport --dports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p udp -m multiport --sports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 135,137,138,139,445,1433,1434 -j DROP 
iptables -A INPUT -p udp -m multiport --dports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p udp -m multiport --sports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p udp -m multiport --dports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP 
iptables -A INPUT -p tcp -m multiport --dports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p udp -m multiport --sports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p udp -m multiport --dports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p udp -m multiport --sports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p udp -m multiport --dports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p udp -m multiport --sports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p udp -m multiport --dports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p udp -m multiport --sports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
#// Drops Tcp flags
iptables -A INPUT -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
iptables -A INPUT -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,PSH,URG -j DROP
iptables -A INPUT -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DROP
iptables -A INPUT -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags RST RST -m limit --limit 2/second --limit-burst 2 -j ACCEPT
iptables -A INPUT -p icmp -m icmp --icmp-type address-mask-request -j DROP
iptables -A INPUT -p icmp -m icmp --icmp-type timestamp-request -j DROP
iptables -A INPUT -p icmp -m limit --limit 2/second --limit-burst 2 -j ACCEPT
iptables -A INPUT -p icmp -j DROP
iptables -A INPUT -s 224.0.0.0/4 -j DROP
iptables -A INPUT -d 224.0.0.0/4 -j DROP
iptables -A INPUT -s 240.0.0.0/5 -j DROP
iptables -A INPUT -d 240.0.0.0/5 -j DROP
iptables -A INPUT -s 0.0.0.0/8 -j DROP
iptables -A INPUT -d 0.0.0.0/8 -j DROP
iptables -A INPUT -d 239.255.255.0/24 -j DROP
iptables -A INPUT -d 255.255.255.255 -j DROP
#//Tcp Flags
iptables -A INPUT -p tcp --tcp-flags ACK,FIN FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags ACK,PSH PSH -j DROP
iptables -A INPUT -p tcp --tcp-flags ACK,URG URG -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL SYN,FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL URG,PSH,FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL URG,PSH,SYN,FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags FIN,RST FIN,RST -j DROP
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
iptables -A INPUT -p tcp --tcp-flags SYN,ACK SYN,ACK -m state --state NEW -j DROP
iptables -A INPUT -p tcp --tcp-flags SYN,FIN SYN,FIN -j DROP
iptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP
iptables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP
iptables -t mangle -A PREROUTING -p tcp -m conntrack --ctstate NEW -m tcpmss ! --mss 536:65535 -j DROP
#//Tcp Flags
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP

iptables -t mangle -A PREROUTING -s 224.0.0.0/3 -j DROP 
iptables -t mangle -A PREROUTING -s 169.254.0.0/16 -j DROP 
iptables -t mangle -A PREROUTING -s 172.16.0.0/12 -j DROP 
iptables -t mangle -A PREROUTING -s 192.0.2.0/24 -j DROP 
iptables -t mangle -A PREROUTING -s 192.168.0.0/16 -j DROP 
iptables -t mangle -A PREROUTING -s 10.0.0.0/8 -j DROP 
iptables -t mangle -A PREROUTING -s 0.0.0.0/8 -j DROP 
iptables -t mangle -A PREROUTING -s 240.0.0.0/5 -j DROP 
iptables -t mangle -A PREROUTING -s 127.0.0.0/8 ! -i lo -j DROP
#// Lengths of bypasses // Common methods.
iptables -A INPUT -p udp -m length --length 1024 -j DROP
iptables -A INPUT -p udp -m length --length 1400 -j DROP 
iptables -A INPUT -p udp -m length --length 1300 -j DROP
iptables -A INPUT -p udp -m length --length 1025 -j DROP
iptables -A INPUT -p udp -m length --length 1212 -j DROP
iptables -A INPUT -p tcp -m length --length 1212 -j DROP
iptables -A INPUT -p tcp -m length --length 1025 -j DROP
iptables -A INPUT -p tcp -m length --length 1300 -j DROP
iptables -A INPUT -p tcp -m length --length 1400 -j DROP
iptables -A INPUT -p udp -m length --length 1456 -j DROP
#// These next tables will block method strings that would normally smack an OVH on an open port
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROPP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|ffffffff6765746368616c6c656e676520302022|" --algo kmp -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|00000000000000000000000000000000|" --algo kmp --from 32 --to 33 -j DROP
iptables -A INPUT -p udp -m u32 --u32 "22&0xFFFF=0x0008" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -A INPUT -p tcp -m u32 --u32 "22&0xFFFF=0x0008" -j DROP
iptables -A INPUT -p tcp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -I INPUT -p tcp -i ens160 -m state --state NEW -m recent --update --seconds 1000 --hitcount 1 -j DROP
iptables -A INPUT -d 107.167.0.0/24 -j DROP 
iptables -A INPUT -d 104.251.0.0/24 -j DROP 
iptables -A INPUT -d 104.160.0.0/24 -j DROP 
iptables -A INPUT -d 126.123.0.0/24 -j DROP 
iptables -A INPUT -d 126.123.0.0/24 -j DROP
iptables -A INPUT -d 182.61.0.0/24 -j DROP
iptables -A INPUT -d 27.50.0.0/24 -j DROP 
iptables -A INPUT -d 62.254.0.0/24 -j DROP
iptables -A INPUT -d 170.75.0.0/24 -j DROP
iptables -A INPUT -d 42.81.0.0/24 -j DROP
iptables -A INPUT -d 65.49.0.0/24 -j DROP 
iptables -A INPUT -d 117.18.0.0/24 -j DROP
iptables -A INPUT -d 52.79.0.0/24 -j DROP 
iptables -A INPUT -d 176.102.0.0/24 -j DROP
iptables -A INPUT -d 98.126.0.0/24 -j DROP 
iptables -A INPUT -d 59.188.0.0/24 -j DROP
iptables -A INPUT -d 153.121.0.0/24 -j DROP
iptables -A INPUT -d 150.95.0.0/24 -j DROP 
iptables -A INPUT -d 62.28.0.0/24 -j DROP
iptables -A INPUT -d 107.161.0.0/24 -j DROP 
iptables -A INPUT -d 67.21.0.0/24 -j DROP 
iptables -A INPUT -d 13.127.0.0/24 -j DROP
iptables -A INPUT -d 98.126.0.0/24 -j DROP
iptables -A INPUT -d 133.130.0.0/24 -j DROP
iptables -A INPUT -d 188.226.0.0/24 -j DROP
iptables -A INPUT -d 185.149.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 151.236.0.0/24 -j DROP
iptables -A INPUT -d 204.188.0.0/24 -j DROP
iptables -A INPUT -d 72.175.0.0/24 -j DROP
iptables -A INPUT -d 185.38.0.0/24 -j DROP
iptables -A INPUT -d 185.149.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 107.167.0.0/24 -j DROP
iptables -A INPUT -d 162.219.0.0/24 -j DROP
iptables -A INPUT -d 176.104.0.0/24 -j DROP
iptables -A INPUT -d 42.180.0.0/24 -j DROP
iptables -A INPUT -d 118.45.0.0/24 -j DROP
iptables -A INPUT -d 13.124.0.0/24 -j DROP
iptables -A INPUT -d 115.22.0.0/24 -j DROP
iptables -A INPUT -d 185.81.0.0/24 -j DROP
iptables -A INPUT -d 182.161.0.0/24 -j DROP
iptables -A INPUT -d 185.186.0.0/24 -j DROP
iptables -A INPUT -d 76.164.0.0/24 -j DROP
iptables -A INPUT -d 85.105.0.0/24 -j DROP
iptables -A INPUT -d 112.87.0.0/24 -j DROP
iptables -A INPUT -d 159.93.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 83.240.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 185.135.0.0/24 -j DROP
iptables -A INPUT -d 76.164.0.0/24 -j DROP
iptables -A INPUT -d 202.253.0.0/24 -j DROP 
iptables -A INPUT -d 159.93.0.0/24 -j DROP
iptables -A INPUT -d 172.82.0.0/24 -j DROP
iptables -A INPUT -d 176.9.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 193.77.0.0/24 -j DROP
iptables -A INPUT -d 185.159.0.0/24 -j DROP
iptables -A INPUT -d 176.53.0.0/24 -j DROP
iptables -A INPUT -d 182.171.0.0/24 -j DROP
iptables -A INPUT -d 104.131.0.0/24 -j DROP
iptables -A INPUT -d 181.215.0.0/24 -j DROP
iptables -A INPUT -d 156.54.0.0/24 -j DROP
#// Helps block amp methods 
iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP 			
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -t mangle -A PREROUTING -p icmp -j DROP
iptables -A INPUT -p tcp --tcp-flags RST RST -m limit --limit 2/s --limit-burst 2 -j ACCEPT
iptables -A INPUT -p tcp --tcp-flags RST RST -j DROP
iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -t mangle -A PREROUTING -p icmp -j DROP
iptables -I PREROUTING -i eth0 -t raw -p udp -m length --length 1052 -j DROP 
iptables -I PREROUTING -i eth0 -t raw -p udp -m length --length 540 -j DROP
iptables -I PREROUTING -i eth0 -t raw -p tcp -m multiport --dports 47873,24870,41100 -j DROP
iptables -I PREROUTING -i eth0 -t raw -p udp -m multiport --sports 3284,30718,161,38,41794,123 -j DROP
iptables -I PREROUTING -i eth0 -t raw -p udp -m multiport --dports 47873,24870,5277 -j DROP
iptables -I OUTPUT -p tcp --tcp-flags RST RST -m limit --limit 4/s -j ACCEPT
iptables -A OUTPUT -p tcp --tcp-flags RST RST -j DROP
iptables -A INPUT -m state --state INVALID -j DROP
iptables -A FORWARD -m state --state INVALID -j DROP
iptables -A OUTPUT -m state --state INVALID -j DROP
iptables -t mangle -A PREROUTING -p udp -m string --algo bm --hex-string "|53414d5033|" -m length --length 39 -j DROP

iptables -N LOGPSCAN
iptables -A LOGPSCAN -p tcp --syn -m limit --limit 3600/hour -j RETURN
iptables -A LOGPSCAN -m limit --limit 200/hour -j LOG --log-prefix "DROPPED Port scan: "
iptables -A LOGPSCAN -j DROP
iptables -A INPUT -p tcp --syn -j LOGPSCAN

iptables -N UDPLIMIT
iptables -A UDPLIMIT --match hashlimit --hashlimit-upto 18000/minute --hashlimit-mode srcip --hashlimit-name udp_rate_limit -j RETURN
iptables -A UDPLIMIT --match limit --limit 5/min -j LOG --log-prefix "DROPPED UDP Flood: "
iptables -A UDPLIMIT -j DROP
iptables -A INPUT -p udp -j UDPLIMIT
iptables -N RATE-LIMIT
iptables -A RATE-LIMIT --match hashlimit --hashlimit-upto 18000/minute --hashlimit-mode srcip --hashlimit-name tcp_rate_limit -j ACCEPT
iptables -A RATE-LIMIT --match limit --limit 10/min -j LOG --log-prefix "DROPPED TCP Rate-Limit: "
iptables -A RATE-LIMIT -j DROP


https://github.com/OVHTooGoated/Simple-IP-Tables/blob/bf3c37b959c2fbdf425d349366e64cbe410fee79/iptables/ovh_patches.txt


iptables -I INPUT -p udp --dport 16000:29000 -m string --to 75 --algo bm --string 'HTTP/1.1 200 OK' -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|7374640000000000|" --algo kmp --from 28 --to 29 -j DROP
iptables -A INPUT -p udp -m u32 --u32 "6&0xFF=0,2:5,7:16,18:255" -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0xFFFF" -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -A INPUT -m string --algo bm --from 28 --to 29 --string "farewell" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|53414d50|" --algo kmp --from 28 --to 29 -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m length --length 0:32 -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m length --length 2521:65535 -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m length --length 98 -j DROP
iptables -A INPUT -p tcp -ack -m length --length 52 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP #Yubina-Kill-ACK
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -m limit --limit 50/s -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -m limit --limit 50/s -j DROP
iptables -A FORWARD -p tcp --syn -m limit --limit 1/s -j ACCEPT
iptables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -m limit --limit 50/s -j ACCEPT
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP #Yubina-RST
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP # Super rescue for Minecraft servers
iptables -A INPUT -m string --algo bm --string "" -j DROP #Empty Long IT/STR/PL
iptables -A INPUT -m string --algo bm --string "U" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP #SAO-UDP Strings

iptables -A INPUT -m string --algo bm --string "\x77" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6\xB1\x94" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6\xB1\x94\xD6" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6\xB1\x94\xD6\x7A\x6B" -j DROP #OVH-SMACK Bypass Strings/
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,ACK FIN -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags PSH,ACK PSH -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags ACK,URG URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,RST FIN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,PSH,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,PSH,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,ACK,URG -j DROP
iptables -A INPUT -p tcp -m tcp --sport 443 --tcp-flags SYN,ACK SYN,ACK -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT
iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,ACK SYN,ACK -j DROP  iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP iptables -A INPUT -m state --state RELATED,ESTABLISHED -m limit --limit 10/sec --limit-burst 15 -j ACCEPT
iptables -A INPUT -p tcp --sport 80 --syn -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT iptables -A INPUT -p tcp -m connlimit --connlimit-above 150 -j DROP iptables -A INPUT -p tcp --sport 443 --syn -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT iptables -FORWARD DROP ovh kill patch
iptables -I INPUT -p udp -m udp -m string --hex-string "|ffbbbfefbbbeffbbbfebffffefbbbf30783030303230303031|" --algo kmp -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|f0ffffffef6765746368616c6c656e676520302022|" --algo kmp -j ACCEPT
iptables -I INPUT -p udp -m udp -m string --hex-string "|c0cf0fffef6765746368616c6c656e676520302022|" --algo kmp -j DROP
iptables -A OUTPUT ! -s 127.198.148.58/32 ! -d 127.77.75.129/32 -p icmp -m icmp --icmp-type 3/3 -m connmark ! --mark 0x7ba5407d -j DROP
iptables -A OUTPUT ! -s 127.231.45.126/32 ! -d 127.20.246.233/32 -p tcp -m tcp --sport 61001:65535 --tcp-flags RST RST -m connmark ! --mark 0x407ee413 -j DROP
iptables -A OUTPUT ! -s 127.198.148.58/32 ! -d 127.77.75.129/32 -p icmp -m icmp --icmp-type 3/3 -m connmark ! --mark 0x7ba5407d -j DROP
iptables -A OUTPUT ! -s 127.231.45.126/32 ! -d 127.20.246.233/32 -p tcp -m tcp --sport 61001:65535 --tcp-flags RST RST -m connmark ! --mark 0x407ee413 -j DROP
iptables -A INPUT -p tcp -ack -m length --length 52 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -m limit --limit 50/s -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -m limit --limit 50/s -j DROP
iptables -A FORWARD -p tcp --syn -m limit --limit 1/s -j ACCEPT
iptables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -m limit --limit 50/s -j ACCEPT
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -t mangle -A PREROUTING -p udp -m multiport --sports 3283,37810,7001,17185,3072,3702,32414,177,6881,5683,41794,2362,11211,53413,17,1900,10001,389,137,5351,502 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 37810 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 7001 -j DROP
iptables -I INPUT -p udp -m length --length 100:140 -m string --string "nAFS" --algo kmp -j DROP
iptables -I INPUT -p udp -m length --length 100:140 -m string --string "OpenAFS" --algo kmp -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 17185 -j DROP
iptables -t mangle -A PREROUTING -p udp -m multiport --sports 3072,3702 -j DROP
iptables -t mangle -A PREROUTING -p tcp -m multiport --sports 3072,3702 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 32414 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 177 -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 6881 -m length --length 320:330 -j DROP
iptables -t mangle -A PREROUTING -p udp -m length --length 280:300 --sport 32414 -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,ACK FIN -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags PSH,ACK PSH -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags ACK,URG URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,RST FIN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,PSH,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,PSH,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,ACK,URG -j DROP
iptables -A INPUT -p tcp -m tcp --sport 443 --tcp-flags SYN,ACK SYN,ACK -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT
iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,ACK SYN,ACK -j DROP  iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP iptables -A INPUT -m state --state RELATED,ESTABLISHED -m limit --limit 10/sec --limit-burst 15 -j ACCEPT
iptables -A INPUT -p tcp --sport 80 --syn -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT iptables -A INPUT -p tcp -m connlimit --connlimit-above 150 -j DROP 
iptables -A INPUT -p tcp --sport 443 --syn -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT iptables -FORWARD DROP ovh kill patch
iptables -A INPUT -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT
iptables -A INPUT -m conntrack --ctstate INVALID -j DROP
iptables -A INPUT -p tcp -m tcp -m connlimit --connlimit-above 8 --connlimit-mask 32 --connlimit-saddr -j DROP
iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -p icmp -m icmp ! --icmp-type 8 -j ACCEPT
iptables -P INPUT DROP
iptables -N ovh_rape
iptables -A INPUT -p udp -m string --algo kmp --hex-string "|fe fe fe fe fe|" --from 28 -j ovh_rape
iptables -A ovh_rape -m limit --limit 100/s --limit-burst 500 -j RETURN
iptables -A ovh_rape -j DROP
ipset -N ovh_rape
iptables -t raw -A PREROUTING -s 155.133.246.0/23 -j DROP
iptables -t raw -A PREROUTING -s 155.133.248.0/24 -j DROP
iptables -t raw -A PREROUTING -s 162.254.192.0/24 -j DROP
iptables -t raw -A PREROUTING -s 162.254.193.0/24 -j DROP
iptables -t raw -A PREROUTING -s 13.107.14.0/24 -j DROP
iptables -t raw -A PREROUTING -s 52.112.0.0/14 -j  DROP
iptables -t raw -A PREROUTING -s 216.58.215.0/24 -j DROP
iptables -t raw -A PREROUTING -s 216.239.36.0/24 -j DROP
iptables -t raw -A PREROUTING -s 67.199.248.0/24 -j DROP
iptables -t raw -A PREROUTING -s 66.249.64.0/20 -j DROP
iptables -N ovh_rape
iptables -A INPUT -p udp -m set --match-set ovh_rape src -m limit -j ovh_rape
iptables -A ovh_rape -m limit --limit 1000/s -j RETURN
iptables -A ovh_rape -j DROP
iptables -A INPUT -p tcp -m connlimit --connlimit-above 80 -j REJECT --reject-with tcp-reset
iptables -t mangle -A PREROUTING -f -j DROP
iptables -t mangle -A PREROUTING -f -j DROP
iptables -A INPUT -p udp -m multiport --dports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p udp -m multiport --sports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p udp -m multiport --dports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p udp -m multiport --sports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p udp -m multiport --dports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p udp -m multiport --sports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p udp -m multiport --dports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p udp -m multiport --sports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p udp -m multiport --dports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p udp -m multiport --sports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p udp -m multiport --dports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p udp -m multiport --sports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x00","\x01","\x02","\x03","\x04","\x05","\x06","\x07","\x08","\x09","\x0a","\x0b","\x0c","\x                                   0d","\x0e","\x0f","\x10","\x11","\x12","\x13","\x14","\x15","\x16","\x17","\x18","\x19","\x1a","\x1b","\x1c","\x1d","\x1e","\x1f","\x20","\x21","\x22","\x23","                                   \x24","\x25","\x26","\x27","\x28","\x29","\x2a","\x2b","\x2c","\x2d","\x2e","\x2f","\x30","\x31","\x32","\x33","\x34","\x35","\x36","\x37","\x38","\x39","\x3a"                                   ,"\x3b","\x3c","\x3d","\x3e","\x3f","\x40","\x41","\x42","\x43","\x44","\x45","\x46","\x47","\x48","\x49","\x4a","\x4b","\x4c","\x4d","\x4e","\x4f","\x50","\x5                                   1","\x52","\x53","\x54","\x55","\x56","\x57","\x58","\x59","\x5a","\x5b","\x5c","\x5d","\x5e","\x5f","\x60","\x61","\x62","\x63","\x64","\x65","\x66","\x67","\                                   x68","\x69","\x6a","\x6b","\x6c","\x6d","\x6e","\x6f","\x70","\x71","\x72","\x73","\x74","\x75","\x76","\x77","\x78","\x79","\x7a","\x7b","\x7c","\x7d","\x7e",                                   "\x7f","\x80","\x81","\x82","\x83","\x84","\x85","\x86","\x87","\x88","\x89","\x8a","\x8b","\x8c","\x8d","\x8e","\x8f","\x90","\x91","\x92","\x93","\x94","\x95                                   ","\x96","\x97","\x98","\x99","\x9a","\x9b","\x9c","\x9d","\x9e","\x9f","\xa0","\xa1","\xa2","\xa3","\xa4","\xa5","\xa6","\xa7","\xa8","\xa9","\xaa","\xab","\x                                   ac","\xad","\xae","\xaf","\xb0","\xb1","\xb2","\xb3","\xb4","\xb5","\xb6","\xb7","\xb8","\xb9","\xba","\xbb","\xbc","\xbd","\xbe","\xbf","\xc0","\xc1","\xc2","                                   \xc3","\xc4","\xc5","\xc6","\xc7","\xc8","\xc9","\xca","\xcb","\xcc","\xcd","\xce","\xcf","\xd0","\xd1","\xd2","\xd3","\xd4","\xd5","\xd6","\xd7","\xd8","\xd9"                                   ,"\xda","\xdb","\xdc","\xdd","\xde","\xdf","\xe0","\xe1","\xe2","\xe3","\xe4","\xe5","\xe6","\xe7","\xe8","\xe9","\xea","\xeb","\xec","\xed","\xee","\xef","\xf                                   0","\xf1","\xf2","\xf3","\xf4","\xf5","\xf6","\xf7","\xf8","\xf9","\xfa","\xfb","\xfc","\xfd","\xfe","\xff" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string ""\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x03\x77\x77\x77\x06\x67\x6f\x6f\x67\x6c\x65\x03\x63\x6f\x6d\x00\x00\x01\x00\x01"" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x03\x77\x77\x77\x06\x67\x6f\x6f\x67\x6c\x65\x03\x63\x6f\x6d\x00\x00\x05\x00\x01" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x72\xFE\x1D\x13\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xA0\x00\x01\x97\x7C\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\xd9\x00\x0a\xfa\x00\x00\x00\x00\x00\x01\x02\x90\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc5\x02\x04\xec\xec\x42\xee\x92" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x03\x77\x77\x77\x06\x67\x6f\x6f\x67\x6c\x65\x03\x63\x6f\x6d\x00\x00\x05\x00\x01" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x30\x3A\x02\x01\x03\x30\x0F\x02\x02\x4A\x69\x02\x03\x00\xFF\xE3\x04\x01\x04\x02\x01\x03\x04\       x10\x30\x0E\x04\x00\x02\x01\x00\x02\x01\x00\x04\x00\x04\x00\x04\x00\x30\x12\x04\x00\x04\x00\xA0\x0C\x02\x02\x37\xF0\x02\x01\x00\x02\x01\x00\x30\x00" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x00\x01\x00\x02\x00\x01\x00" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x30\x84\x00\x00\x00\x2d\x02\x01\x07\x63\x84\x00\x00\x00\x24\x04\x00\x0a\x01\x00\x0a\x01\x00\       x02\x01\x00\x02\x01\x64\x01\x01\x00\x87\x0b\x6f\x62\x6a\x65\x63\x74\x43\x6c\x61\x73\x73\x30\x84\x00\x00\x00\x00" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x00\x11\x22\x33\x44\x55\x66\x77\x00\x00\x00\x00\x00\x00\x00\x00\x01\x10\x02\x00\x00\x00\x00\       x00\x00\x00\x00\xC0\x00\x00\x00\xA4\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x98\x01\x01\x00\x04\x03\x00\x00\x24\x01\x01\x00\x00\x80\x01\x00\x05\x80\x02\x00       \x02\x80\x03\x00\x01\x80\x04\x00\x02\x80\x0B\x00\x01\x00\x0C\x00\x04\x00\x00\x00\x01\x03\x00\x00\x24\x02\x01\x00\x00\x80\x01\x00\x05\x80\x02\x00\x01\x80\x03\x0       0\x01\x80\x04\x00\x02\x80\x0B\x00\x01\x00\x0C\x00\x04\x00\x00\x00\x01\x03\x00\x00\x24\x03\x01\x00\x00\x80\x01\x00\x01\x80\x02\x00\x02\x80\x03\x00\x01\x80\x04\x00\x02\x80\x0B\x00\x01\x00\x0C\x00\x04\x00\x00\x00\x01" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x06\x00\xff\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x09\x20\x18\xc8\x81\x00\x38\x8e\x04\xb5"-j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "SNQUERY: 127.0.0.1:AAAAAA:xsvr" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "8d\xc1x\x01\xb8\x9b\xcb\x8f\0\0\0\0\0" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x02" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x1e\x00\x01\x30\x02\xfd\xa8\xe3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x4d\x2d\x53\x45\x41\x52\x43\x48\x20\x2a\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\x0d\x0a\x48\x4f\       x53\x54\x3a\x20\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x3a\x31\x39\x30\x30\x0d\x0a\x4d\x41\x4e\x3a\x20\x22\x73\x73\x64\x70\x3a\x64\x69\x73       \x63\x6f\x76\x65\x72\x22\x0d\x0a\x4d\x58\x3a\x20\x31\x0d\x0a\x53\x54\x3a\x20\x75\x72\x6e\x3a\x64\x69\x61\x6c\x2d\x6d\x75\x6c\x74\x69\x73\x63\x72\x65\x65\x6e\x2       d\x6f\x72\x67\x3a\x73\x65\x72\x76\x69\x63\x65\x3a\x64\x69\x61\x6c\x3a\x31\x0d\x0a\x55\x53\x45\x52\x2d\x41\x47\x45\x4e\x54\x3a\x20\x47\x6f\x6f\x67\x6c\x65\x20\x       43\x68\x72\x6f\x6d\x65\x2f\x36\x30\x2e\x30\x2e\x33\x31\x31\x32\x2e\x39\x30\x20\x57\x69\x6e\x64\x6f\x77\x73\x0d\x0a\x0d\x0a" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x09_services\x07_dns-sd\x04_udp\x05local\x00\x00\x0C\x00\x01" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "xf4\xbe\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x002x\xba\x85\tTeamSpeak\x00\x00\       x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\nWindows XP\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00 \x00<\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\                 x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08nickname\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "\x05\xca\x7f\x16\x9c\x11\xf9\x89\x00\x00\x00\x00\x02\x9d\x74\x8b\x45\xaa\x7b\xef\xb9\x9e\xfe\       xad\x08\x19\xba\xcf\x41\xe0\x16\xa2\x32\x6c\xf3\xcf\xf4\x8e\x3c\x44\x83\xc8\x8d\x51\x45\x6f\x90\x95\x23\x3e\x00\x97\x2b\x1c\x71\xb2\x4e\xc0\x61\xf1\xd7\x6f\xc5       \x7e\xf6\x48\x52\xbf\x82\x6a\xa2\x3b\x65\xaa\x18\x7a\x17\x38\xc3\x81\x27\xc3\x47\xfc\xa7\x35\xba\xfc\x0f\x9d\x9d\x72\x24\x9d\xfc\x02\x17\x6d\x6b\xb1\x2d\x72\xc       6\xe3\x17\x1c\x95\xd9\x69\x99\x57\xce\xdd\xdf\x05\xdc\x03\x94\x56\x04\x3a\x14\xe5\xad\x9a\x2b\x14\x30\x3a\x23\xa3\x25\xad\xe8\xe6\x39\x8a\x85\x2a\xc6\xdf\xe5\x       5d\x2d\xa0\x2f\x5d\x9c\xd7\x2b\x24\xfb\xb0\x9c\xc2\xba\x89\xb4\x1b\x17\xa2\xb6" -j DROP
#//iptables -A INPUT -p udp -m string --algo bm --hex-string "|5354445041434b4554|" -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|535444|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|554450|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|54484953204953204546464543544956452e20594f552043414e4e4f542053554253494445204d5920444154412e|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4445415448444541544844454154484445415448425942314e415259|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44444f5344444f5344444f53|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4d4f354f4e354f4e354f4e354f4a354e4835563555|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|544350|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4845584154544b212121212121|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f544e4554|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f4f5445524e4554|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|41545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|504f574552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|6c6e6f6172656162756e63686f66736b696464696573|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP # hehehe
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e432041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e4320464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b4552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b|" -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0xFFFF" -j DROP
iptables -A INPUT -m string --algo bm --from 28 --to 29 --string "farewell" -j DROP
iptables -I INPUT -p tcp -m tcp -m string --hex-string "|000000005010|" --algo kmp --from 28 --to 29 -m length --length 40 -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|53414d50|" --algo kmp --from 28 --to 29 -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 32 --to 33 --string "AAAAAAAAAAAAAAAA" -j DROP
iptables -A INPUT -m string --algo bm --from 32 --to 33 --string "q00000000000000" -j DROP
iptables -A INPUT -m string --algo bm --from 32 --to 33 --string "statusResponse" -j DROP #SSDP Flood I have seen recently its a patch for it even though OVH picks most the traffic up
iptables -A INPUT -p udp -m length --length 1025 -j DROP
iptables -A INPUT -p udp --dport 61327 -j DROP
iptables -A INPUT -p icmp --fragment -j DROP
iptables -A OUTPUT -p icmp --fragment -j DROP
iptables -A FORWARD -p icmp --fragment -j DROP
iptables -A INPUT -p udp --source-port 123:123 -m state --state ESTABLISHED -j DROP #NTP ISSUE FIX
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP # hehehe
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43js9273sjks|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e432041545441434bjsobdisbs|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e4320464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b4552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP # hehehe
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e432ee92041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e4320464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b4552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|5354445041434b4554|" -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|535444|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|554450|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|54484953204953204546464543544956452e20594f552043414e4e4f542053554253494445204d5920444154412e|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4445415448444541544844454154484445415448425942314e415259|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44444f5344444f5344444f53|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4d4f354f4e354f4e354f4e354f4a354e4835563555|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|544350|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4845584154544b212121212121|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f544e4554|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f4f5445524e4554|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|41545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|504f574552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|6c6e6f6172656162756e63686f66736b696464696573|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP # hehehe
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e432041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e4320464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b4552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b|" -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0xFFFF" -j DROP
iptables -A INPUT -m string --algo bm --from 28 --to 29 --string "farewell" -j DROP
iptables -I INPUT -p tcp -m tcp -m string --hex-string "|000000005010|" --algo kmp --from 28 --to 29 -m length --length 40 -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|53414d50|" --algo kmp --from 28 --to 29 -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 32 --to 33 --string "AAAAAAAAAAAAAAAA" -j DROP
iptables -A INPUT -m string --algo bm --from 32 --to 33 --string "q00000000000000" -j DROP
iptables -A INPUT -m string --algo bm --from 32 --to 33 --string "statusResponse" -j DROP #SSDP Flood I have seen recently its a patch for it even though OVH picks most the traffic up
iptables -A INPUT -p udp -m length --length 1025 -j DROP
iptables -A INPUT -p udp --dport 61327 -j DROP
iptables -A INPUT -p icmp --fragment -j DROP
iptables -A OUTPUT -p icmp --fragment -j DROP
iptables -A FORWARD -p icmp --fragment -j DROP
iptables -A INPUT -p udp --source-port 123:123 -m state --state ESTABLISHED -j DROP #NTP ISSUE FIX
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP # hehehe
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43js9273sjks|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e432041545441434bjsobdisbs|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e4320464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b4552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP # hehehe
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e432ee92041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e4320464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4841434b4552|" -j DROP
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -i lo -j ACCEPT
iptables -A INPUT -m recent --update --hitcount 10 --name SYN-DROP --seconds 86400 -j DROP
iptables -A INPUT -m recent --update --hitcount 5 --name SYN-DROP --seconds 3600 -j DROP
iptables -N SYN
iptables -A SYN -m limit --limit 10/min --limit-burst 3 -j LOG --log-level warning --log-prefix "[SYN: DROP]"
iptables -A SYN -m limit --limit 10/min --limit-burst 3 -m recent --set --name SYN-DROP -j DROP
iptables -A SYN -j DROP
iptables -A INPUT -p UDP -m length --length 1:1024 -m recent --set --name GetStatus
iptables -A INPUT -p UDP -m string --algo bm --hex-string "|ff ff ff ff 67 65 74 73 74 61 74 75 73|" -m recent --update --seconds 1 --hitcount 5 --nameGetStatus -j DROP
iptables -N syn-flood
iptables -A INPUT -i $TAP -p tcp --syn -j syn-flood
iptables -N syn-flood
iptables -A syn-flood -m limit --limit 10/sec --limit-burst 15 -j RETURN
iptables -A syn-flood -j LOG --log-prefix "SYN flood: "
iptables -A syn-flood -j DROP
iptables -N http-flood
iptables -A INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 1 -j http-flood
iptables -A INPUT -p tcp --syn --dport 443 -m connlimit --connlimit-above 1 -j http-flood
iptables -A http-flood -m limit --limit 10/s --limit-burst 10 -j RETURN
iptables -A http-flood -m limit --limit 1/s --limit-burst 10 -j LOG --log-prefix "HTTP-FLOOD "
iptables -A http-flood -j DROP


iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROPP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|77 70 61 64 2e 64 6f 6d 61 69 6e 2e 6e 61 6d 65|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbf307830303030303030303030433032313130|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbf30783030363030453030|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbf30783030363030453038|' -j DROP
iptables -I INPUT 1 -p udp --dport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 22 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 62305 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --dport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT 1 -p udp --sport 443 --match string --algo kmp --hex-string '|Efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|' -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|ffffffff6765746368616c6c656e676520302022|" --algo kmp -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|00000000000000000000000000000000|" --algo kmp --from 32 --to 33 -j DROP
iptables -A INPUT -p udp -m u32 --u32 "22&0xFFFF=0x0008" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -A INPUT -p tcp -m u32 --u32 "22&0xFFFF=0x0008" -j DROP
iptables -A INPUT -p tcp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -I INPUT -p tcp -i ens160 -m state --state NEW -m recent --update --seconds 1000 --hitcount 1 -j DROP
iptables -A INPUT -d 107.167.0.0/24 -j DROP 
iptables -A INPUT -d 104.251.0.0/24 -j DROP 
iptables -A INPUT -d 104.160.0.0/24 -j DROP 
iptables -A INPUT -d 126.123.0.0/24 -j DROP 
iptables -A INPUT -d 126.123.0.0/24 -j DROP
iptables -A INPUT -d 182.61.0.0/24 -j DROP
iptables -A INPUT -d 27.50.0.0/24 -j DROP 
iptables -A INPUT -d 62.254.0.0/24 -j DROP
iptables -A INPUT -d 170.75.0.0/24 -j DROP
iptables -A INPUT -d 42.81.0.0/24 -j DROP
iptables -A INPUT -d 65.49.0.0/24 -j DROP 
iptables -A INPUT -d 117.18.0.0/24 -j DROP
iptables -A INPUT -d 52.79.0.0/24 -j DROP 
iptables -A INPUT -d 176.102.0.0/24 -j DROP
iptables -A INPUT -d 98.126.0.0/24 -j DROP 
iptables -A INPUT -d 59.188.0.0/24 -j DROP
iptables -A INPUT -d 153.121.0.0/24 -j DROP
iptables -A INPUT -d 150.95.0.0/24 -j DROP 
iptables -A INPUT -d 62.28.0.0/24 -j DROP
iptables -A INPUT -d 107.161.0.0/24 -j DROP 
iptables -A INPUT -d 67.21.0.0/24 -j DROP 
iptables -A INPUT -d 13.127.0.0/24 -j DROP
iptables -A INPUT -d 98.126.0.0/24 -j DROP
iptables -A INPUT -d 133.130.0.0/24 -j DROP
iptables -A INPUT -d 188.226.0.0/24 -j DROP
iptables -A INPUT -d 185.149.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 151.236.0.0/24 -j DROP
iptables -A INPUT -d 204.188.0.0/24 -j DROP
iptables -A INPUT -d 72.175.0.0/24 -j DROP
iptables -A INPUT -d 185.38.0.0/24 -j DROP
iptables -A INPUT -d 185.149.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 107.167.0.0/24 -j DROP
iptables -A INPUT -d 162.219.0.0/24 -j DROP
iptables -A INPUT -d 176.104.0.0/24 -j DROP
iptables -A INPUT -d 42.180.0.0/24 -j DROP
iptables -A INPUT -d 118.45.0.0/24 -j DROP
iptables -A INPUT -d 13.124.0.0/24 -j DROP
iptables -A INPUT -d 115.22.0.0/24 -j DROP
iptables -A INPUT -d 185.81.0.0/24 -j DROP
iptables -A INPUT -d 182.161.0.0/24 -j DROP
iptables -A INPUT -d 185.186.0.0/24 -j DROP
iptables -A INPUT -d 76.164.0.0/24 -j DROP
iptables -A INPUT -d 85.105.0.0/24 -j DROP
iptables -A INPUT -d 112.87.0.0/24 -j DROP
iptables -A INPUT -d 159.93.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 83.240.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 185.135.0.0/24 -j DROP
iptables -A INPUT -d 76.164.0.0/24 -j DROP
iptables -A INPUT -d 202.253.0.0/24 -j DROP 
iptables -A INPUT -d 159.93.0.0/24 -j DROP
iptables -A INPUT -d 172.82.0.0/24 -j DROP
iptables -A INPUT -d 176.9.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 193.77.0.0/24 -j DROP
iptables -A INPUT -d 185.159.0.0/24 -j DROP
iptables -A INPUT -d 176.53.0.0/24 -j DROP
iptables -A INPUT -d 182.171.0.0/24 -j DROP
iptables -A INPUT -d 104.131.0.0/24 -j DROP
iptables -A INPUT -d 181.215.0.0/24 -j DROP
iptables -A INPUT -d 156.54.0.0/24 -j DROP

iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -t mangle -A PREROUTING -p icmp -j DROP
iptables -A INPUT -p tcp --tcp-flags RST RST -m limit --limit 2/s --limit-burst 2 -j ACCEPT
iptables -A INPUT -p tcp --tcp-flags RST RST -j DROP
iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -t mangle -A PREROUTING -p icmp -j DROP
iptables -I PREROUTING -i eth0 -t raw -p udp -m length --length 1052 -j DROP 
iptables -I PREROUTING -i eth0 -t raw -p udp -m length --length 540 -j DROP
iptables -I PREROUTING -i eth0 -t raw -p tcp -m multiport --dports 47873,24870,41100 -j DROP
iptables -I PREROUTING -i eth0 -t raw -p udp -m multiport --sports 3284,30718,161,38,41794,123 -j DROP
iptables -I PREROUTING -i eth0 -t raw -p udp -m multiport --dports 47873,24870,5277 -j DROP
iptables -I OUTPUT -p tcp --tcp-flags RST RST -m limit --limit 4/s -j ACCEPT
iptables -A OUTPUT -p tcp --tcp-flags RST RST -j DROP
iptables -A INPUT -m state --state INVALID -j DROP
iptables -A FORWARD -m state --state INVALID -j DROP
iptables -A OUTPUT -m state --state INVALID -j DROP
iptables -t mangle -A PREROUTING -p udp -m string --algo bm --hex-string "|53414d5033|" -m length --length 39 -j DROP














iptables -N ovh_rape
iptables -A INPUT -p udp -m string --algo kmp --hex-string "|fe fe fe fe fe|" --from 28 -j ovh_rape
iptables -A ovh_rape -m limit --limit 100/s --limit-burst 500 -j RETURN
iptables -A ovh_rape -j DROP
ipset -N ovh_rape
iptables -t raw -A PREROUTING -s 155.133.246.0/23 -j DROP
iptables -t raw -A PREROUTING -s 155.133.248.0/24 -j DROP
iptables -t raw -A PREROUTING -s 162.254.192.0/24 -j DROP
iptables -t raw -A PREROUTING -s 162.254.193.0/24 -j DROP
iptables -t raw -A PREROUTING -s 13.107.14.0/24 -j DROP
iptables -t raw -A PREROUTING -s 52.112.0.0/14 -j  DROP
iptables -t raw -A PREROUTING -s 216.58.215.0/24 -j DROP
iptables -t raw -A PREROUTING -s 216.239.36.0/24 -j DROP
iptables -t raw -A PREROUTING -s 67.199.248.0/24 -j DROP
iptables -t raw -A PREROUTING -s 66.249.64.0/20 -j DROP
iptables -N ovh_rape
iptables -A INPUT -p udp -m set --match-set ovh_rape src -m limit -j ovh_rape
iptables -A ovh_rape -m limit --limit 1000/s -j RETURN
iptables -A ovh_rape -j DROP

ip route add blackhole 123.59.116.0/24
ip route add blackhole 172.105.154.0/24
ip route add blackhole 92.63.197.0/24
iptables -A INPUT -d 123.59.0.0/24 -j DROP
iptables -A INPUT -d 92.222.0.0/24 -j DROP
iptables -A INPUT -d 74.207.0.0/24 -j DROP
iptables -A INPUT -d 142.44.0.0/24 -j DROP
iptables -A INPUT -d 66.228.0.0/24 -j DROP
ip route add blackhole 172.105.154.0/24
ip route add blackhole 45.143.200.0/24
ip route add blackhole 74.207.225.0/24
ip route add blackhole 66.228.41.0/24
ip route add blackhole 142.44.206.0/24
ip route add blackhole 66.228.41.0/24
ip route add blackhole 74.207.225.0/24
ip route add blackhole 173.255.210.0/24
ip route add blackhole 142.44.206.0/24
ip route add blackhole 172.105.154.0/24


iptables -A INPUT -p udp -m multiport --dports 62625,34506,43054 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 62625,34506,43054 -j DROP
iptables -A INPUT -p udp -m multiport --sports 62625,34506,42758,42762 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 62625,34506,42758,42762 -j DROP


ip route add blackhole 142.44.206.109
ip route add blackhole 52.224.146.30
ip route add blackhole 1.214.62.104
ip route add blackhole 43.132.197.151 
iptables -A INPUT -d 142.44.0.0/24 -j DROP
iptables -A INPUT -d 146.185.0.0/24 -j DROP 
iptables -A INPUT -d 103.226.0.0/24 -j DROP
iptables -A INPUT -p udp -m multiport --dports 58420,60757,37269 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 58420,60757,37269 -j DROP
iptables -A INPUT -p udp -m multiport --sports 35154 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 35145 -j DROP

iptables -A INPUT -p udp -m multiport --dports 58950,30817,60914,44343,21092 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 58950,30817,60914,44343,21092 -j DROP
iptables -A INPUT -p udp -m multiport --sports 58950,20883,62757,64416,4912 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 58950,20883,62757,64416,4912 -j DROP
iptables -A INPUT -p udp -m multiport --dports 59566,38598,14227,38810,20639,29881,37054,28265,50152,18096,37409,1703,19630,25000 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 59566,38598,14227,38810,20639,29881,37054,28265,50152,18096,37409,1703,19630,25000 -j DROP
iptables -A INPUT -p udp -m multiport --sports 26986,24495,20639,33215,32043,42920,28921,21725,56489,4773,35254,39907,60190,61354 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 26986,24495,20639,33215,32043,42920,28921,21725,56489,4773,35254,39907,60190,61354 -j DROP
iptables -A INPUT -p udp -m multiport --dports 4230,52196,31653,8942,64490,38460,49772,56698,33010,37054,3478,20573,3478,15323 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 4230,52196,31653,8942,64490,38460,49772,56698,33010,37054,3478,20573,3478,15323 -j DROP
iptables -A INPUT -p udp -m multiport --dports 60859,38174,60803,37203,41777,43760,40051,37131,45070 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 60859,38174,60803,37203,41777,43760,40051,37131,45070 -j DROP
iptables -A INPUT -p udp -m multiport --sports 60859,38174,60803 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 60859,38174,60803 -j DROP

iptables -A INPUT -d 189.201.0.0/24 -j DROP
iptables -A INPUT -d 173.245.0.0/24 -j DROP
iptables -A INPUT -d 185.71.0.0/24 -j DROP
iptables -A INPUT -d 13.107.0.0/24 -j DROP
iptables -A INPUT -d 52.114.0.0/24 -j DROP
iptables -A INPUT -d 162.254.0.0/24 -j DROP
iptables -A INPUT -d 73.95.0.0/24 -j DROP
iptables -A INPUT -d 106.12.0.0/24 -j DROP
iptables -A INPUT -d 156.254.0.0/24 -j DROP
iptables -A INPUT -d 162.254.0.0/24 -j DROP
iptables -A INPUT -d 149.20.0.0/24 -j DROP
iptables -A INPUT -d 199.19.0.0/24 -j DROP
iptables -A INPUT -d 52.114.0.0/24 -j DROP
iptables -A INPUT -d 141.101.0.0/24 -j DROP
iptables -A INPUT -d 23.235.0.0/24 -j DROP
iptables -A INPUT -d 192.198.0.0/24 -j DROP
iptables -A INPUT -d 62.102.0.0/24 -j DROP
iptables -A INPUT -d 172.69.0.0/24 -j DROP
iptables -A INPUT -d 106.12.0.0/24 -j DROP
iptables -A INPUT -d 108.84.0.0/24 -j DROP
iptables -A INPUT -d 74.125.0.0/24 -j DROP
iptables -A INPUT -d 209.112.0.0/24 -j DROP
iptables -A INPUT -d 108.162.0.0/24 -j DROP
iptables -A INPUT -d 185.228.0.0/24 -j DROP
iptables -A INPUT -d 70.166.0.0/24 -j DROP
iptables -A INPUT -d 104.18.0.0/24 -j DROP
iptables -A INPUT -d 141.101.0.0/24 -j DROP
iptables -A INPUT -d 66.240.0.0/24 -j DROP
iptables -A INPUT -d 50.7.0.0/24 -j DROP
iptables -A INPUT -d 23.235.0.0/24 -j DROP
iptables -A INPUT -d 173.245.0.0/24 -j DROP
iptables -A INPUT -d 136.243.0.0/24 -j DROP
iptables -A INPUT -d 211.75.0.0/24 -j DROP
iptables -A INPUT -d 190.2.0.0/24 -j DROP
iptables -A INPUT -d 67.199.0.0/24 -j DROP
iptables -A INPUT -d 192.5.0.0/24 -j DROP
iptables -A INPUT -d 173.245.0.0/24 -j DROP
iptables -A INPUT -d 194.25.0.0/24 -j DROP
iptables -A INPUT -d 196.216.0.0/24 -j DROP
iptables -A INPUT -d 199.180.0.0/24 -j DROP
iptables -A INPUT -d 189.201.0.0/24 -j DROP
iptables -A INPUT -d 162.158.0.0/24 -j DROP
iptables -A INPUT -d 111.230.0.0/24 -j DROP
iptables -A INPUT -d 194.177.0.0/24 -j DROP
iptables -A INPUT -d 194.0.0.0/24 -j DROP
iptables -A INPUT -d 192.113.0.0/24 -j DROP
iptables -A INPUT -d 192.33.0.0/24 -j DROP
iptables -A INPUT -d 80.82.0.0/24 -j DROP
iptables -A INPUT -d 199.249.0.0/24 -j DROP
iptables -A INPUT -d 35.177.0.0/24 -j DROP
iptables -A INPUT -d 3.134.0.0/24 -j DROP
iptables -A INPUT -d 18.223.0.0/24 -j DROP
iptables -A INPUT -d 150.199.0.0/24 -j DROP
iptables -A INPUT -d 3.14.0.0/24 -j DROP
iptables -A INPUT -d 187.188.0.0/24 -j DROP
iptables -A INPUT -d 34.224.0.0/24 -j DROP
iptables -A INPUT -d 54.80.0.0/24 -j DROP
iptables -A INPUT -d 18.212.0.0/24 -j DROP


ip route add blackhole 13.107.246.0/24
ip route add blackhole 141.101.76.0/24
ip route add blackhole 159.89.153.0/24
ip route add blackhole 162.158.183.0/24
ip route add blackhole 180.250.115.0/24
ip route add blackhole 111.231.112.0/24
ip route add blackhole 202.31.190.0/24
ip route add blackhole 199.7.83.0/24
ip route add blackhole 216.239.36.0/24
ip route add blackhole 69.36.145.0/24
ip route add blackhole 162.254.197.0/24
ip route add blackhole 91.224.149.0/24
ip route add blackhole 193.0.9.0/24
ip route add blackhole 40.77.167.0/24
ip route add blackhole 155.133.248.0/24
ip route add blackhole 37.44.238.0/24
ip route add blackhole 137.74.155.0/24
ip route add blackhole 54.36.24.0/24
ip route add blackhole 37.44.238.0/24
ip route add blackhole 137.74.155.0/24
ip route add blackhole 54.36.24.0/24
ip route add blackhole 103.161.16.0/24
ip route add blackhole 172.107.97.0/24
ip route add blackhole 47.88.92.0/24
ip route add blackhole 73.232.151.0/24
ip route add blackhole 186.236.20.0/24
ip route add blackhole 76.108.109.0/24
ip route add blackhole 92.118.161.0/24
ip route add blackhole 77.68.2.0/24
ip route add blackhole 216.99.21.0/24
ip route add blackhole 36.110.228.0/24
ip route add blackhole 50.115.168.0/24
ip route add blackhole 77.123.155.0/24
ip route add blackhole 79.124.62.0/24
ip route add blackhole 185.30.176.0/24
ip route add blackhole 222.211.148.0/24
ip route add blackhole 45.145.66.0/24
ip route add blackhole 42.112.67.0/24
ip route add blackhole 176.111.173.0/24
ip route add blackhole 92.223.65.0/24
ip route add blackhole 193.142.59.0/24
ip route add blackhole 187.170.24.0/24
ip route add blackhole 45.88.137.0/24
ip route add blackhole 164.90.216.0/24
ip route add blackhole 64.62.197.0/24




iptables -A INPUT -d 96.96.0.0/24 -j DROP
iptables -A INPUT -d 51.68.0.0/24 -j DROP
iptables -A INPUT -d 39.108.0.0/24 -j DROP
iptables -A INPUT -d 117.54.0.0/24 -j DROP
iptables -A INPUT -d 114.6.0.0/24 -j DROP
iptables -A INPUT -d 43.155.0.0/24 -j DROP
iptables -A INPUT -d 5.9.0.0/24 -j DROP
iptables -A INPUT -d 5.167.0.0/24 -j DROP
iptables -A INPUT -d 150.254.0.0/24 -j DROP
iptables -A INPUT -d 124.70.0.0/24 -j DROP
iptables -A INPUT -d 159.149.0.0/24 -j DROP
iptables -A INPUT -d 85.114.0.0/24 -j DROP
iptables -A INPUT -d 210.77.0.0/24 -j DROP
iptables -A INPUT -d 192.193.0.0/24 -j DROP
iptables -A INPUT -d 43.129.0.0/24 -j DROP
iptables -A INPUT -d 181.224.0.0/24 -j DROP
iptables -A INPUT -d 202.83.0.0/24 -j DROP
iptables -A INPUT -d 189.50.0.0/24 -j DROP
iptables -A INPUT -d 174.141.0.0/24 -j DROP
iptables -A INPUT -d 39.98.0.0/24 -j DROP
iptables -A INPUT -d 46.202.0.0/24 -j DROP
iptables -A INPUT -d 184.1055.0.0/24 -j DROP
iptables -A INPUT -d 187.87.0.0/24 -j DROP
iptables -A INPUT -d 71.2.0.0/24 -j DROP
iptables -A INPUT -d 102.66.0.0/24 -j DROP
iptables -A INPUT -d 45.8.0.0/24 -j DROP
iptables -A INPUT -d 51.68.0.0/24 -j DROP
iptables -A INPUT -d 46.206.0.0/24 -j DROP
iptables -A INPUT -d 184.105.0.0/24 -j DROP
iptables -A INPUT -d 51.68.0.0/24 -j DROP
iptables -A INPUT -d 186.176.0.0/24 -j DROP
iptables -A INPUT -d 188.168.0.0/24 -j DROP
iptables -A INPUT -d 197.246.0.0/24 -j DROP
iptables -A INPUT -d 5.9.0.0/24 -j DROP
iptables -A INPUT -d 140.238.0.0/24 -j DROP
iptables -A INPUT -d 186.176.0.0/24 -j DROP
iptables -A INPUT -d 184.105.0.0/24 -j DROP
iptables -A INPUT -d 187.87.0.0/24 -j DROP
iptables -A INPUT -d 210.77.0.0/24 -j DROP
iptables -A INPUT -d 134.209.0.0/24 -j DROP
iptables -A INPUT -d 159.65.0.0/24 -j DROP
iptables -A INPUT -d 5.9.0.0/24 -j DROP
iptables -A INPUT -d 58.20.0.0/24 -j DROP
iptables -A INPUT -d 46.206.0.0/24 -j DROP
iptables -A INPUT -d 198.23.0.0/24 -j DROP
iptables -A INPUT -d 184.105.0.0/24 -j DROP
iptables -A INPUT -d 139.99.0.0/24 -j DROP
iptables -A INPUT -d 201.62.0.0/24 -j DROP
iptables -A INPUT -d 41.79.0.0/24 -j DROP
iptables -A INPUT -d 104.40.0.0/24 -j DROP
iptables -A INPUT -d 186.176.0.0/24 -j DROP
iptables -A INPUT -d 149.36.0.0/24 -j DROP
iptables -A INPUT -d 47.90.0.0/24 -j DROP
iptables -A INPUT -d 171.96.0.0/24 -j DROP
iptables -A INPUT -d 117.4.0.0/24 -j DROP
iptables -A INPUT -d 134.209.0.0/24 -j DROP
iptables -A INPUT -d 106.54.0.0/24 -j DROP
iptables -A INPUT -d 143.208.0.0/24 -j DROP
iptables -A INPUT -d 101.132.0.0/24 -j DROP
iptables -A INPUT -d 151.72.0.0/24 -j DROP
iptables -A INPUT -d 177.128.0.0/24 -j DROP
iptables -A INPUT -d 143.108.0.0/24 -j DROP
iptables -A INPUT -d 180.97.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 103.88.0.0/24 -j DROP
iptables -A INPUT -d 134.170.0.0/24 -j DROP
iptables -A INPUT -d 186.176.0.0/24 -j DROP
iptables -A INPUT -d 41.63.0.0/24 -j DROP
iptables -A INPUT -d 20.194.0.0/24 -j DROP
iptables -A INPUT -d 143.208.0.0/24 -j DROP
iptables -A INPUT -d 170.155.0.0/24 -j DROP
iptables -A INPUT -d 103.42.0.0/24 -j DROP
iptables -A INPUT -d 68.183.0.0/24 -j DROP
iptables -A INPUT -d 186.176.0.0/24 -j DROP
iptables -A INPUT -d 37.113.0.0/24 -j DROP
iptables -A INPUT -d 209.45.0.0/24 -j DROP
iptables -A INPUT -d 92.84.0.0/24 -j DROP
iptables -A INPUT -d 185.118.0.0/24 -j DROP
iptables -A INPUT -d 103.92.0.0/24 -j DROP
iptables -A INPUT -d 79.117.0.0/24 -j DROP
iptables -A INPUT -d 45.227.0.0/24 -j DROP
iptables -A INPUT -d 14.139.0.0/24 -j DROP
iptables -A INPUT -d 92.255.0.0/24 -j DROP
iptables -A INPUT -d 197.242.0.0/24 -j DROP
iptables -A INPUT -d 91.132.0.0/24 -j DROP
iptables -A INPUT -d 173.52.0.0/24 -j DROP
iptables -A INPUT -d 37.44.0.0/24 -j DROP
iptables -A INPUT -d 209.45.0.0/24 -j DROP
iptables -A INPUT -d 92.84.0.0/24 -j DROP
iptables -A INPUT -d 185.118.0.0/24 -j DROP
iptables -A INPUT -d 103.92.0.0/24 -j DROP
iptables -A INPUT -d 79.117.0.0/24 -j DROP
iptables -A INPUT -d 45.227.0.0/24 -j DROP
iptables -A INPUT -d 14.139.0.0/24 -j DROP
iptables -A INPUT -d 92.255.0.0/24 -j DROP
iptables -A INPUT -d 197.242.0.0/24 -j DROP
iptables -A INPUT -d 91.132.0.0/24 -j DROP
iptables -A INPUT -d 54.37.0.0/24 -j DROP
iptables -A INPUT -d 103.161.0.0/24 -j DROP
iptables -A INPUT -d 137.74.0.0/24 -j DROP
iptables -A INPUT -d 54.36.0.0/24 -j DROP
iptables -A INPUT -d 92.63.0.0/24 -j DROP
iptables -A INPUT -d 18.118.0.0/24 -j DROP
iptables -A INPUT -d 208.52.0.0/24 -j DROP
iptables -A INPUT -d 10.251.0.0/24 -j DROP
iptables -A INPUT -d 47.92.0.0/24 -j DROP
iptables -A INPUT -d 45.143.0.0/24 -j DROP
iptables -A INPUT -d 47.88.0.0/24 -j DROP

iptables -A INPUT -d 140.142.0.0/24 -j DROP
iptables -A INPUT -d 45.86.0.0/24 -j DROP
iptables -A INPUT -d 138.201.0.0/24 -j DROP




iptables -I INPUT -p udp -m length --length 1045 -j REJECT
iptables -I INPUT -p udp -m length --length 1176 -j REJECT
iptables -I INPUT -p udp -m length --length 910 -j REJECT
iptables -I INPUT -p udp -m length --length 1012 -j REJECT
iptables -I INPUT -p udp -m length --length 154-j REJECT
iptables -I INPUT -p udp -m length --length 818 -j REJECT
iptables -I INPUT -p udp -m length --length 944 -j REJECT
iptables -I INPUT -p udp -m length --length 1013 -j REJECT
iptables -I INPUT -p udp -m length --length 146 -j REJECT
iptables -I INPUT -p udp -m length --length 864 -j REJECT
iptables -I INPUT -p udp -m length --length 616 -j REJECT
iptables -I INPUT -p udp -m length --length 1054 -j REJECT
iptables -I INPUT -p udp -m length --length 1218 -j REJECT
iptables -I INPUT -p udp -m length --length 142 -j REJECT



iptables -A INPUT -p udp -m udp --sport 3702 -j REJECT
iptables -A INPUT -p udp -m udp --sport 20817 -j REJECT
iptables -A INPUT -p udp -m udp --dport 35350 -j REJECT
iptables -A INPUT -p udp -m udp --dport 36000 -j REJECT

iptables -A INPUT -s 10.0.0.0/8 -j DROP
iptables -A INPUT -s 169.254.0.0/16 -j DROP
iptables -A INPUT -s 172.16.0.0/12 -j DROP
iptables -A INPUT -i eth0 -s 127.0.0.0/8 -j DROP

iptables -A INPUT -s 224.0.0.0/4 -j DROP
iptables -A INPUT -d 224.0.0.0/4 -j DROP
iptables -A INPUT -s 240.0.0.0/5 -j DROP
iptables -A INPUT -d 240.0.0.0/5 -j DROP
iptables -A INPUT -s 0.0.0.0/8 -j DROP
iptables -A INPUT -d 0.0.0.0/8 -j DROP
iptables -A INPUT -d 239.255.255.0/24 -j DROP
iptables -A INPUT -d 255.255.255.255 -j DROP
iptables -t mangle -A PREROUTING -s 224.0.0.0/3 -j DROP
iptables -t mangle -A PREROUTING -s 169.254.0.0/16 -j DROP
iptables -t mangle -A PREROUTING -s 172.16.0.0/12 -j DROP
iptables -t mangle -A PREROUTING -s 192.0.2.0/24 -j DROP
iptables -t mangle -A PREROUTING -s 192.168.0.0/16 -j DROP
iptables -t mangle -A PREROUTING -s 10.0.0.0/8 -j DROP
iptables -t mangle -A PREROUTING -s 0.0.0.0/8 -j DROP
iptables -t mangle -A PREROUTING -s 240.0.0.0/5 -j DROP
iptables -t mangle -A PREROUTING -s 127.0.0.0/8 ! -i lo -j DROP
iptables -A INPUT -s 10.0.0.0/8 -j DROP
iptables -A INPUT -s 169.254.0.0/16 -j DROP
iptables -A INPUT -s 172.16.0.0/12 -j DROP
iptables -A INPUT -i eth0 -s 127.0.0.0/8 -j DROP
iptables -A INPUT -s 224.0.0.0/4 -j DROP
iptables -A INPUT -d 224.0.0.0/4 -j DROP
iptables -A INPUT -s 240.0.0.0/5 -j DROP
iptables -A INPUT -d 240.0.0.0/5 -j DROP
iptables -A INPUT -s 0.0.0.0/8 -j DROP
iptables -A INPUT -d 0.0.0.0/8 -j DROP
iptables -A INPUT -d 239.255.255.0/24 -j DROP
iptables -A INPUT -d 255.255.255.255 -j DROP
iptables -A INPUT -s 169.254.0.0/16 -j DROP
iptables -A INPUT -s 172.16.0.0/12 -j DROP
iptables -A INPUT -s 127.0.0.0/8 -j DROP
iptables -A INPUT -s 224.0.0.0/4 -j DROP
iptables -A INPUT -d 224.0.0.0/4 -j DROP
iptables -A INPUT -s 240.0.0.0/5 -j DROP
iptables -A INPUT -d 240.0.0.0/5 -j DROP
iptables -A INPUT -s 0.0.0.0/8 -j DROP
iptables -A INPUT -d 0.0.0.0/8 -j DROP









iptables -t raw -A PREROUTING -p udp -m length --length 65535 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-65535 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 60000 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-60000 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 30000 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-30000 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 10000 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-10000 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 4096 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-4096 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 1052 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-1052 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 1000 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-1052 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 912 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-912 packets/4
iptables -t raw -A PREROUTING -p udp -m length --length 540 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-540 packets/3
iptables -t raw -A PREROUTING -p udp -m length --length 55 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-55 packets/1
iptables -t raw -A PREROUTING -p udp -m length --length 38 -j DROP #Malicious Botnet-UDP Payload / UDP flood/37
iptables -A PREROUTING -p udp -m length --length 0:28 -j DROP #Dropping Empty UDP Packets / Deemed Illegitimate Packets
iptables -A INPUT -p udp -m u32 --u32 "2&0xFFFF=0x2:0x0100" #Generic-UDP-Header-Sequence
iptables -A INPUT -p udp -m u32 --u32 "12&0xFFFFFF00=0xC0A80F00" -j DROP #Katura-UDP-Payload
iptables -A INPUT -p tcp -syn -m length --length 52 u32 --u32 "12&0xFFFFFF00=0xc838" -j DROP #Mikey-Shit-TCP
iptables -A INPUT -p udp -m length --length 28 -m string --algo bm --string "0x0010" -j DROP #Botnet UDP
iptables -A INPUT -p udp -m length --length 28 -m string --algo bm --string "0x0000" -j DROP #Botnet UDP
iptables -A INPUT -p tcp -m length --length 40 -m string --algo bm --string "0x0020" -j DROP #Botnet TCP
iptables -A INPUT -p tcp -m length --length 40 -m string --algo bm --string "0x0c54" -j DROP #Botnet TCP
iptables -A INPUT -p tcp -m length --length 40 -m string --algo bm --string "0x38d3" -j DROP #Botnet TCP
iptables -A INPUT -p tcp -ack -m length --length 52 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP #Yubina-Kill-ACK
iptables -A INPUT -p tcp -syn -m length --length 52 -m string --algo bm --string "0xc838" -m state --state ESTABLISHED  -j DROP 



 
 
 
### Create chains ###
iptables -N syn_flood
iptables -N LOGGING
iptables -N port-scanning 

### Drop invalid packets ### 
/sbin/iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP

### Drop TCP packets that are new and are not SYN ### 
/sbin/iptables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP 
 
### Drop SYN packets with suspicious MSS value ### 
/sbin/iptables -t mangle -A PREROUTING -p tcp -m conntrack --ctstate NEW -m tcpmss ! --mss 536:65535 -j DROP

### Drop fragments in all chains ### 
iptables -t mangle -A PREROUTING -f -j DROP

### Limit connections per source IP ### 
iptables -A INPUT -p tcp -m connlimit --connlimit-above 111 -j REJECT --reject-with tcp-reset

### Limit RST packets ### 
iptables -A INPUT -p tcp --tcp-flags RST RST -m limit --limit 2/s --limit-burst 2 -j ACCEPT 
iptables -A INPUT -p tcp --tcp-flags RST RST -j DROP

### Limit new TCP connections per second per source IP ### 
iptables -A INPUT -p tcp -m conntrack --ctstate NEW -m limit --limit 60/s --limit-burst 20 -j ACCEPT 
iptables -A INPUT -p tcp -m conntrack --ctstate NEW -j DROP

### SSH brute-force protection ### 
iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --set 
iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --update --seconds 60 --hitcount 10 -j LOGGING

### Protection against SYN flood ###
iptables -A INPUT -p tcp --syn -j syn_flood
iptables -A syn_flood -m limit --limit 1/s --limit-burst 3 -j LOGGING
iptables -A syn_flood -j DROP

### Logging section ###
iptables -A LOGGING -m limit --limit 2/min -j LOG --log-prefix "IPTables-Dropped: " --log-level 4
iptables -A LOGGING -j DROP;
  



iptables -I INPUT 1 -p tcp --dport 1337 --match string --algo kmp --hex-string '|2d 93 05 39 44 2e 00 00 67 c5 6d 35 50 18 8d 47 76 f5 00 00|' -j DROP
iptables -I INPUT 1 -p tcp --sport 11667 --match string --algo kmp --hex-string '|2d 93 05 39 44 2e 00 00 67 c5 6d 35 50 18 8d 47 76 f5 00 00|' -j DROP
iptables -I INPUT 1 -p tcp --dport 11667 --match string --algo kmp --hex-string '|2d 93 05 39 44 2e 00 00 67 c5 6d 35 50 18 8d 47 76 f5 00 00|' -j DROP
iptables -I INPUT 1 -p tcp --sport 1337 --match string --algo kmp --hex-string '|2d 93 05 39 44 2e 00 00 67 c5 6d 35 50 18 8d 47 76 f5 00 00|' -j DROP


iptables -N ovh_africa
iptables -A INPUT -p udp -m string --algo kmp --hex-string "|fe fe fe fe fe|" --from 28 -j ovh_africa
iptables -A ovh_rape -m limit --limit 100/s --limit-burst 500 -j RETURN
iptables -A ovh_rape -j DROP
ipset -N ovh_africa
iptables -t raw -A PREROUTING -s 37.44.238.0/23 -j DROP
iptables -t raw -A PREROUTING -s 199.192.20.0/24 -j DROP
iptables -t raw -A PREROUTING -s 31.220.55.0/24 -j DROP
iptables -t raw -A PREROUTING -s 173.205.126.0/24 -j DROP
iptables -t raw -A PREROUTING -s 61.166.249.0/24 -j DROP
iptables -t raw -A PREROUTING -s 27.80.225.0/14 -j  DROP
iptables -t raw -A PREROUTING -s 217.128.195.0/24 -j DROP
iptables -t raw -A PREROUTING -s 123.57.225.0/24 -j DROP
iptables -t raw -A PREROUTING -s 181.129.103.0/24 -j DROP
iptables -t raw -A PREROUTING -s 199.168.91.22.0/24 -j DROP
iptables -t raw -A PREROUTING -s 119.148.24.0/24 -j DROP
iptables -t raw -A PREROUTING -s 78.21.242.0/24 -j DROP
iptables -t raw -A PREROUTING -s 61.247.171.0/24 -j DROP
iptables -t raw -A PREROUTING -s 18.206.59.0/24 -j DROP
iptables -t raw -A PREROUTING -s 18.22.170.0/24 -j DROP
iptables -t raw -A PREROUTING -s 193.29.57.0/24 -j DROP
iptables -t raw -A PREROUTING -s 171.99.135.0/24 -j DROP
iptables -t raw -A PREROUTING -s 103.16.70.0/24 -j DROP
iptables -t raw -A PREROUTING -s 18.224.229.0/24 -j DROP
iptables -t raw -A PREROUTING -s 125.137.217.0/24 -j DROP
iptables -t raw -A PREROUTING -s 75.108.117.0/24 -j DROP
iptables -t raw -A PREROUTING -s 71.78.72.0/24 -j DROP
iptables -N ovh_africa
iptables -A INPUT -p udp -m set --match-set ovh_rape src -m limit -j ovh_africa
iptables -A ovh_africa -m limit --limit 1000/s -j RETURN
iptables -A ovh_africa -j DROP

iptables -A INPUT -p tcp -m multiport --sports 34157,35434,10780 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 11804,12812,12820 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 12860,12896,13118 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 12860,12896,13118,24112 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 14701,16030,16371,17460,1804,19760 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 20231,20381.21023,23766,23918 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 24719,25444,32774,33067,33069,33202 -j DROP
ip route add blackhole 186.176.212.212
ip route add blackhole 36.71.139.27
ip route add blackhole 116.73.14.16
ip route add blackhole 103.92.114.2
ip route add blackhole 200.87.180.66
ip route add blackhole 197.8.80.180
ip route add blackhole 14.97.160.170
ip route add blackhole 103.156.216.178
ip route add blackhole 110.74.208.154
ip route add blackhole 41.65.162.75
ip route add blackhole 190.152.182.150

iptables -A INPUT -p tcp -m multiport --sports 60803,38174,60859 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 58687,48534,55626 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 35223,56784 -j DROP

iptables -A INPUT -d 107.167.0.0/24 -j DROP
iptables -A INPUT -d 104.251.0.0/24 -j DROP
iptables -A INPUT -d 104.160.0.0/24 -j DROP
iptables -A INPUT -d 126.123.0.0/24 -j DROP
iptables -A INPUT -d 126.123.0.0/24 -j DROP
iptables -A INPUT -d 182.61.0.0/24 -j DROP
iptables -A INPUT -d 27.50.0.0/24 -j DROP
iptables -A INPUT -d 62.254.0.0/24 -j DROP
iptables -A INPUT -d 170.75.0.0/24 -j DROP
iptables -A INPUT -d 42.81.0.0/24 -j DROP
iptables -A INPUT -d 65.49.0.0/24 -j DROP
iptables -A INPUT -d 117.18.0.0/24 -j DROP
iptables -A INPUT -d 52.79.0.0/24 -j DROP
iptables -A INPUT -d 176.102.0.0/24 -j DROP
iptables -A INPUT -d 98.126.0.0/24 -j DROP
iptables -A INPUT -d 59.188.0.0/24 -j DROP
iptables -A INPUT -d 153.121.0.0/24 -j DROP
iptables -A INPUT -d 150.95.0.0/24 -j DROP
iptables -A INPUT -d 62.28.0.0/24 -j DROP
iptables -A INPUT -d 107.161.0.0/24 -j DROP
iptables -A INPUT -d 67.21.0.0/24 -j DROP
iptables -A INPUT -d 13.127.0.0/24 -j DROP
iptables -A INPUT -d 98.126.0.0/24 -j DROP
iptables -A INPUT -d 133.130.0.0/24 -j DROP
iptables -A INPUT -d 188.226.0.0/24 -j DROP
iptables -A INPUT -d 185.149.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 151.236.0.0/24 -j DROP
iptables -A INPUT -d 204.188.0.0/24 -j DROP
iptables -A INPUT -d 72.175.0.0/24 -j DROP
iptables -A INPUT -d 185.38.0.0/24 -j DROP
iptables -A INPUT -d 185.149.0.0/24 -j DROP
iptables -A INPUT -d 144.91.0.0/24 -j DROP
iptables -A INPUT -d 107.167.0.0/24 -j DROP
iptables -A INPUT -d 162.219.0.0/24 -j DROP
iptables -A INPUT -d 176.104.0.0/24 -j DROP
iptables -A INPUT -d 42.180.0.0/24 -j DROP
iptables -A INPUT -d 118.45.0.0/24 -j DROP
iptables -A INPUT -d 13.124.0.0/24 -j DROP
iptables -A INPUT -d 115.22.0.0/24 -j DROP
iptables -A INPUT -d 185.81.0.0/24 -j DROP
iptables -A INPUT -d 182.161.0.0/24 -j DROP
iptables -A INPUT -d 185.186.0.0/24 -j DROP
iptables -A INPUT -d 76.164.0.0/24 -j DROP
iptables -A INPUT -d 85.105.0.0/24 -j DROP
iptables -A INPUT -d 112.87.0.0/24 -j DROP
iptables -A INPUT -d 159.93.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 83.240.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 185.135.0.0/24 -j DROP
iptables -A INPUT -d 76.164.0.0/24 -j DROP
iptables -A INPUT -d 202.253.0.0/24 -j DROP
iptables -A INPUT -d 159.93.0.0/24 -j DROP
iptables -A INPUT -d 172.82.0.0/24 -j DROP
iptables -A INPUT -d 176.9.0.0/24 -j DROP
iptables -A INPUT -d 199.101.0.0/24 -j DROP
iptables -A INPUT -d 193.77.0.0/24 -j DROP
iptables -A INPUT -d 185.159.0.0/24 -j DROP
iptables -A INPUT -d 176.53.0.0/24 -j DROP
iptables -A INPUT -d 182.171.0.0/24 -j DROP
iptables -A INPUT -d 104.131.0.0/24 -j DROP
iptables -A INPUT -d 181.215.0.0/24 -j DROP
iptables -A INPUT -d 156.54.0.0/24 -j DROP
iptables -A INPUT -d 142.44.0.0/24 -j DROP
iptables -A INPUT -d 146.185.0.0/24 -j DROP
iptables -A INPUT -d 103.226.0.0/24 -j DROP
iptables -A INPUT -p udp -m multiport --dports 58420,60757,37269 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 58420,60757,37269 -j DROP
iptables -A INPUT -p udp -m multiport --sports 35154 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 35145 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 43122,52398 -j DROP
iptables -A INPUT -p tcp -m tcp --dport 6969 -m state --state NEW -m recent --set --name DEFAULT --mask 255.255.255.255 --rsource
iptables -A INPUT -p tcp -m tcp --dport 6969 -m state --state NEW -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 6969 -m state --state NEW -m recent --update --seconds 60 --hitcount 4 --name DEFAULT --mask 255.255.255.255 --rsource -j DROP
iptables -A INPUT -d 123.59.0.0/24 -j DROP
iptables -A INPUT -d 92.222.0.0/24 -j DROP
iptables -A INPUT -d 74.207.0.0/24 -j DROP
iptables -A INPUT -d 142.44.0.0/24 -j DROP
iptables -A INPUT -d 66.228.0.0/24 -j DROP
iptables -A INPUT -p tcp -m tcp --dport 22 -j DROP
iptables -A INPUT -s 120.23.207.187/32 -p tcp -m tcp --dport 6969 -j ACCEPT
iptables -A INPUT -s 162.248.92.10/32 -p tcp -m tcp --dport 6969 -j ACCEPT
iptables -A INPUT -s 216.52.148.234/32 -p tcp -m tcp --dport 6969 -j ACCEPT
iptables -A INPUT -s 192.223.24.145/32 -p tcp -m tcp --dport 6969 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 6969 -j DROP
iptables -A INPUT -p udp -m multiport --dports 60859,38174,60803,37203,41777,43760,40051,37131,45070 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 60859,38174,60803,37203,41777,43760,40051,37131,45070 -j DROP
iptables -A INPUT -p udp -m multiport --sports 60859,38174,60803 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 60859,38174,60803 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 60803,38174,60859 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 58687,48534,55626 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 35223,56784 -j DROP
iptables -A INPUT -d 92.63.0.0/24 -j DROP
iptables -A INPUT -d 18.118.0.0/24 -j DROP
iptables -A INPUT -d 208.52.0.0/24 -j DROP
iptables -A INPUT -d 10.251.0.0/24 -j DROP
iptables -A INPUT -d 47.92.0.0/24 -j DROP
iptables -A INPUT -d 45.143.0.0/24 -j DROP
iptables -A INPUT -d 47.88.0.0/24 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 34157,35434,10780 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 11804,12812,12820 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 12860,12896,13118 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 12860,12896,13118,24112 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 14701,16030,16371,17460,1804,19760 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 24719,25444,32774,33067,33069,33202 -j DROP
iptables -A FORWARD -i tun0 -o eth0 -j ACCEPT
iptables -A FORWARD -i eth0 -o tun0 -j ACCEPT

iptables -A INPUT -p udp -m multiport --dports 52736,33308,41063,33299,37913,42030,52047,53153 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 52736,33308,41063,33299,37913,42030,52047,53153 -j DROP
iptables -A INPUT -p udp -m multiport --sports 2088,2102,2148,2132,2103,2089,2091,2134,2145,2029,2091,2133,2162,2164,2104,2174,2090,2028,2146,2144,2030,2149 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 2088,2102,2148,2132,2103,2089,2091,2134,2145,2029,2091,2133,2162,2164,2104,2174,2090,2028,2146,2144,2030,2149 -j DROP
iptables -A INPUT -p udp -m multiport --sports 2105,2166,2137,2175,2103,2151,2136,2135,2173,2092,2146,2176,2104,4160,2138,2093,2136,2106,2179,2167,2031,2147,2153 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 2105,2166,2137,2175,2103,2151,2136,2135,2173,2092,2146,2176,2104,4160,2138,2093,2136,2106,2179,2167,2031,2147,2153 -j DROP
iptables -A INPUT -p udp -m multiport --sports 2044,2153,2113,2194,2111,2124,2170,2126,2156,2114,1912,2185,2114,2117,2115,2126,2128,2158,2172,2155,2127,58319,2200,2117 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 2044,2153,2113,2194,2111,2124,2170,2126,2156,2114,1912,2185,2114,2117,2115,2126,2128,2158,2172,2155,2127,58319,2200,2117 -j DROP
iptables -A INPUT -p udp -m multiport --sports 2177,2207,2146,2072,2134,2132,2178,2133,2191,2179,2146,2137,2133,2135,2208,2206,2188,2209,2073,2218,2180,2075,2180,2148 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 2177,2207,2146,2072,2134,2132,2178,2133,2191,2179,2146,2137,2133,2135,2208,2206,2188,2209,2073,2218,2180,2075,2180,2148 -j DROP



iptables -A INPUT -d 139.177.0.0/24 -j DROP
iptables -A INPUT -d 176.58.0.0/24 -j DROP
iptables -A INPUT -d 139.162.0.0/24 -j DROP
iptables -A INPUT -d 45.79.0.0/24 -j DROP
iptables -A INPUT -d 96.126.0.0/24 -j DROP
iptables -A INPUT -d 181.209.0.0/24 -j DROP
iptables -A INPUT -d 176.58.0.0/24 -j DROP
ip route add blackhole 139.177.183.0/24
ip route add blackhole 45.179.251.0/24
ip route add blackhole 96.126.97.0/24
ip route add blackhole 103.109.59.0/24
iptables -A INPUT -d 50.116.0.0/24 -j DROP
iptables -A INPUT -d 109.237.0.0/24 -j DROP
iptables -A INPUT -d 139.162.0.0/24 -j DROP
iptables -A INPUT -d 216.218.0.0/24 -j DROP
iptables -A INPUT -d 172.105.0.0/24 -j DROP
iptables -A INPUT -d 50.116.0.0/24 -j DROP
iptables -A INPUT -d 67.201.0.0/24 -j DROP
iptables -A INPUT -d 200.6.0.0/24 -j DROP
iptables -A INPUT -d 190.4.0.0/24 -j DROP
iptables -A INPUT -d 50.207.0.0/24 -j DROP
iptables -A INPUT -d 150.116.0.0/24 -j DROP

End
